{"version":3,"file":"static/webpack/static/development/pages/index.js.98aaa2be23f9cf519f48.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["/* eslint-disable jsx-a11y/anchor-is-valid */\n\nimport React from 'react';\nimport Homepage from '../src/containers/homepage';\nimport axios from 'axios';\nimport Preloader from '../src/components/preloader/preloader';\nimport { config } from '../config';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { getTopics, getUser, getToken, setPageNumber } from \"../src/actions/data\";\n// import Bottom from '../src/components/reuseable/bottom';\n// import BottomScrollListerer from 'react-bottom-scroll-listener';\n// import CircularProgress from '@material-ui/core/CircularProgress';\nimport CookieConsent from \"react-cookie-consent\";\nimport { Lang } from '../lang';\nimport Router from \"next/router\";\nimport Head from \"next/head\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport ExpandMore from \"@material-ui/icons/ExpandMore\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { withStyles } from \"@material-ui/core/styles\";\n\n\nconst styles = theme => ({\n  root: {\n    flexGrow: 1,\n    marginTop: 100,\n    minHeight: 45\n  },\n  tab: {\n    alignItems: \"baseline\",\n    padding: 10\n  },\n  pos: {\n    // position: \"absolute\"\n  },\n  progress: {\n    margin: theme.spacing.unit * 2\n  }\n});\n\nclass Index extends React.Component {\n  constructor(props) {\n    super(props);\n    this.timer = null;\n\n    this.state = {\n      loading: true,\n      loadingMore: false\n    };\n  }\n  \n  \n\n  static async getInitialProps({ req }) {\n    // console.log('req', req);\n\n    // const userAgent = req ? req.headers['user-agent'] : navigator.userAgent;\n    let topics = await axios.get(\n      config.api + \"/topic?pageNumber=1&dataType=hot&pageSize=5\"\n    );\n    let dataTopics = JSON.stringify(topics.data.content);\n\n    return {\n      // userAgent,\n      dataTopics\n    };\n  }\n\n  \n\n  async componentDidMount() {\n    const { dataTopics, getTopics, getUser, getToken } = this.props;\n\n    let token = localStorage.getItem(\"token\");\n    let user = sessionStorage.getItem(\"user\");\n\n    this.setState({\n      loading: false\n    });\n\n    getTopics(JSON.parse(dataTopics));\n\n    try {\n      if (token) {\n        if (!user) {\n          const options = {\n            method: \"GET\",\n            headers: {\n              \"content-type\": \"application/json\",\n              \"Access-Control-Allow-Origin\": \"*\",\n              \"x-auth-token\": token\n            },\n            url: config.api + \"/users/me\"\n          };\n          let user = await axios(options);\n          getUser(user.data[0]);\n          sessionStorage.setItem(\n            \"user\",\n            JSON.stringify(user.data[0])\n          );\n          getToken(token);\n        } else {\n          // check if the user details is already saved and stop the loading\n          getUser(JSON.parse(user));\n          this.setState({\n            loading: false\n          });\n          getTopics(JSON.parse(dataTopics));\n          return;\n        }\n      }\n\n\n      this.setState({\n        loading: false\n      });\n\n      // this.timer = setInterval(() => {\n      //   this.handleFetchMoreTopics();\n      // }, 10000);\n    } catch (error) {\n      // console.log(\"error\", error.response);\n      if (error.response.data.error) {\n        localStorage.removeItem(\"token\");\n        Router.push(\"/login?sE=true\");\n      }\n    }\n  }\n\n\n  render() {\n    const { loading, loadingMore } = this.state;\n    const { classes } = this.props;\n    return (\n      <div>\n        <Homepage />\n        <CookieConsent\n          style={{ zIndex: 99999, background: \"rgb(146, 95, 126)\" }}\n          buttonStyle={{ background: \"rgb(255, 255, 255)\" }}\n        >\n          {Lang.m3}\n          {/* This website uses cookies to enhance the user experience.It is your responsibility to keep the coins you earn safe by withdrawing them to your own wallet. */}\n        </CookieConsent>\n      </div>\n    );\n  }\n}\n\n\nfunction mapStateToProps(state) {\n  return {\n    data: state.data,\n  }\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      getTopics: getTopics,\n      getUser: getUser,\n      getToken: getToken,\n      setPageNumber: setPageNumber\n    },\n    dispatch\n  );\n}\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withStyles(styles)(Index));"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AAFA;AAIA;AAAA;AAGA;AACA;AADA;AAbA;AAAA;AACA;AAiBA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAEA;AACA;AACA;AAFA;AAJA;AAQA;AACA;;;;;;;;;;AAqBA;AAEA;AACA;AAEA;AACA;AADA;AAIA;;;AAGA;;;;;AACA;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAPA;;AASA;AACA;;AADA;AACA;AACA;AAIA;;;;;AAEA;AACA;AACA;AACA;AADA;AAGA;;;;AAMA;AACA;AADA;AAKA;AACA;AACA;;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAIA;AAAA;AAAA;AAAA;AAAA;AAGA;AAIA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAFA;AASA;;;;;;;;;AA5FA;;AAIA;AACA;;AADA;AAGA;AAEA;AACA;AACA;AAFA;AACA;;;;;;;;;;;AAvBA;AACA;AA4GA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAJA;AAQA;AACA;AACA;;;;A","sourceRoot":""}